---
/**
 * Select Component
 * YP Design System - Playbook
 *
 * @prop options - Array of { value, label } options
 * @prop placeholder - Placeholder option text
 * @prop label - Optional label
 * @prop error - Error message
 * @prop disabled - Disabled state
 */

interface Option {
  value: string;
  label: string;
  disabled?: boolean;
}

interface Props {
  options: Option[];
  placeholder?: string;
  label?: string;
  error?: string;
  disabled?: boolean;
  required?: boolean;
  name?: string;
  id?: string;
  value?: string;
  class?: string;
}

const {
  options,
  placeholder = "Select an option",
  label,
  error,
  disabled = false,
  required = false,
  name,
  id,
  value,
  class: className = "",
} = Astro.props;

const selectId = id || name || `select-${Math.random().toString(36).slice(2, 9)}`;
const hasError = !!error;
---

<div class={`select-wrapper ${className}`}>
  {label && (
    <label for={selectId} class="select-label">
      {label}
      {required && <span class="text-[var(--state-error)] ml-1">*</span>}
    </label>
  )}

  <div class="select-container">
    <select
      id={selectId}
      name={name}
      disabled={disabled}
      required={required}
      class:list={['select-field', hasError && 'select-error']}
      aria-invalid={hasError}
      aria-describedby={error ? `${selectId}-error` : undefined}
    >
      {placeholder && (
        <option value="" disabled selected={!value}>
          {placeholder}
        </option>
      )}
      {options.map((option) => (
        <option
          value={option.value}
          disabled={option.disabled}
          selected={value === option.value}
        >
          {option.label}
        </option>
      ))}
    </select>

    <span class="select-icon">
      <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </span>
  </div>

  {error && (
    <p id={`${selectId}-error`} class="select-message error">
      {error}
    </p>
  )}
</div>

<style>
  .select-wrapper {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .select-label {
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-secondary);
  }

  .select-container {
    position: relative;
  }

  .select-field {
    width: 100%;
    padding: 0.75rem 2.5rem 0.75rem 1rem;
    background-color: var(--bg-elevated);
    border: 1px solid var(--border-default);
    color: var(--text-primary);
    font-size: 1rem;
    appearance: none;
    cursor: pointer;
    transition: all 200ms ease;
  }

  .select-field:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px rgba(0, 246, 224, 0.1);
  }

  .select-field:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .select-field.select-error {
    border-color: var(--state-error);
  }

  .select-icon {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
  }

  .select-message {
    font-size: 0.75rem;
    margin-top: 0.25rem;
  }

  .select-message.error {
    color: var(--state-error);
  }

  /* Style native options (limited) */
  .select-field option {
    background-color: var(--bg-elevated);
    color: var(--text-primary);
  }

  .select-field option:disabled {
    color: var(--text-muted);
  }
</style>
