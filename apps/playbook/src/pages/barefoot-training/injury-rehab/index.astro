---
import { getCollection } from "astro:content";

// Get Pain Relief drills
const allDrills = await getCollection("drills");
const painReliefDrills = allDrills.filter(
  (d) =>
    d.data.cluster === "pain-relief" ||
    d.data.cluster === "injury-rehab" ||
    d.data.tags.includes("injury-rehab") ||
    d.data.tags.includes("severs-disease") ||
    d.data.tags.includes("osgood-schlatter"),
);

// Get related Q&A
const allQA = await getCollection("parent-sidelines");
const relatedQA = allQA.filter(
  (qa) =>
    qa.data.category === "injury-prevention" ||
    qa.data.keywords.some(
      (k) => k.includes("sever") || k.includes("heel pain") || k.includes("knee pain"),
    ),
);

const breadcrumbs = [
  { label: "Home", url: "/" },
  { label: "Barefoot Training", url: "/barefoot-training/" },
  { label: "Injury Rehab" },
];

const featuredPages = [
  {
    title: "Barefoot Training After Ankle Sprain",
    description: "Modified progressions for returning to barefoot training after ankle injuries.",
    url: "/barefoot-training/injury-rehab/level-1-foundational/ankle/barefoot-after-ankle-sprain",
    icon: "ü¶∂",
    badge: "Common",
  },
  {
    title: "Plantar Fasciitis & Barefoot Training",
    description:
      "Can barefoot training help plantar fasciitis? What the research says and how to do it safely.",
    url: "/barefoot-training/injury-rehab/level-1-foundational/plantar/plantar-fasciitis-barefoot-training",
    icon: "ü©π",
  },
  {
    title: "Flat Feet Exercises",
    description: "Evidence-based exercises for building arch strength in flat-footed athletes.",
    url: "/barefoot-training/injury-rehab/level-1-foundational/flat-feet/flat-feet-exercises-kids",
    icon: "ü¶∂",
    badge: "Popular",
  },
  {
    title: "Growing Pains vs. Injury",
    description: "How to tell the difference and when to seek medical attention.",
    url: "/barefoot-training/injury-rehab/level-1-foundational/growth/growing-pains-vs-injury",
    icon: "üë∂",
  },
  {
    title: "Return to Sport Protocol",
    description: "Step-by-step guide for returning to sport after a foot or ankle injury.",
    url: "/barefoot-training/injury-rehab/level-2-core-skills/return-to-sport/barefoot-return-sport-protocol",
    icon: "üèÉ",
  },
];

const relatedHubs = [
  { title: "Safety Hub", url: "/barefoot-training/safety/", icon: "üõ°Ô∏è" },
  { title: "Start Here", url: "/barefoot-training/start-here/", icon: "üöÄ" },
  { title: "Research", url: "/barefoot-training/research/", icon: "üìö" },
];
---

<ClusterHubLayout
  title="Barefoot Training for Injury Rehab"
  description="Recovering from a foot or ankle injury? Barefoot training can help‚Äîwhen done correctly. This hub contains modified progressions, evidence-based protocols, and guidance on when barefoot work is appropriate."
  canonical="https://playbook.youthperformance.com/barefoot-training/injury-rehab/"
  breadcrumbs={breadcrumbs}
  clusterIcon="ü©π"
  clusterBadge="Injury Recovery"
  featuredPages={featuredPages}
  relatedHubs={relatedHubs}
  showSafetyDisclaimer={true}
  keywords={["barefoot training injury rehab", "foot strengthening after injury", "ankle sprain recovery exercises", "plantar fasciitis barefoot"]}
>
  <!-- Medical Disclaimer -->
  <section class="bg-action-orange/10 border-2 border-action-orange/30 rounded-lg p-6 mb-8">
    <div class="flex items-start gap-4">
      <span class="text-3xl">‚öïÔ∏è</span>
      <div>
        <h2 class="font-display text-xl font-bold mb-2">Important Medical Note</h2>
        <p class="text-bark-soft mb-3">
          The information in this section is for educational purposes and should not replace professional medical advice.
          If you're recovering from an injury:
        </p>
        <ul class="space-y-1 text-sm text-bark-soft ml-5">
          <li>‚Ä¢ Get clearance from your healthcare provider before starting barefoot training</li>
          <li>‚Ä¢ Share these protocols with your physical therapist or doctor</li>
          <li>‚Ä¢ Stop immediately if you experience pain, swelling, or setbacks</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- When Barefoot Training Helps -->
  <section class="mb-12">
    <h2 class="font-display text-2xl font-bold mb-4">When Barefoot Training Helps Recovery</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <div class="bg-moss/5 border border-moss/20 rounded-lg p-5">
        <h3 class="font-display font-semibold text-moss mb-3 flex items-center gap-2">
          <span>‚úì</span> May Help With
        </h3>
        <ul class="space-y-2 text-sm text-bark-soft">
          <li>‚Ä¢ Ankle sprain recovery (post-acute phase)</li>
          <li>‚Ä¢ Plantar fasciitis (when appropriate)</li>
          <li>‚Ä¢ Mild flat feet / fallen arches</li>
          <li>‚Ä¢ General foot weakness</li>
          <li>‚Ä¢ Balance deficits after injury</li>
          <li>‚Ä¢ Proprioception retraining</li>
        </ul>
      </div>
      <div class="bg-action-orange/5 border border-action-orange/20 rounded-lg p-5">
        <h3 class="font-display font-semibold text-action-orange mb-3 flex items-center gap-2">
          <span>‚úó</span> Likely Not Appropriate For
        </h3>
        <ul class="space-y-2 text-sm text-bark-soft">
          <li>‚Ä¢ Acute injuries (first 2-4 weeks)</li>
          <li>‚Ä¢ Stress fractures (until fully healed)</li>
          <li>‚Ä¢ Severe structural issues (require ortho eval)</li>
          <li>‚Ä¢ Nerve damage / neuropathy</li>
          <li>‚Ä¢ Active infections</li>
          <li>‚Ä¢ Post-surgical (without clearance)</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Growth-Related Pain Protocols -->
  {painReliefDrills.length > 0 && (
    <section class="mb-12">
      <h2 class="font-display text-2xl font-bold mb-4">Growth-Related Pain Protocols</h2>
      <p class="text-bark-soft mb-6 max-w-2xl">
        The "Big Three" growth-related conditions in young athletes. Each protocol uses isometric loading to reduce pain while building tendon tolerance.
      </p>
      <div class="space-y-8">
        {painReliefDrills.map((drill, index) => (
          <div id={drill.data.slug}>
            <DrillCard
              number={index + 1}
              title={drill.data.title}
              tags={drill.data.tags.slice(0, 3)}
              ageBadge={{ label: `${drill.data.ageMin}-${drill.data.ageMax}`, class: drill.data.ageMin < 10 ? "age-7-9" : "age-10-13" }}
              description={drill.data.description}
              steps={drill.data.steps}
              coachingCues={drill.data.coachingCues}
              duration={drill.data.duration}
              reps={drill.data.reps}
              difficulty={drill.data.difficulty.charAt(0).toUpperCase() + drill.data.difficulty.slice(1) as "Beginner" | "Intermediate" | "Advanced" | "Scalable"}
            />
            {drill.data.coachNote && (
              <div class="mt-4 ml-4 pl-4 border-l-2 border-copper bg-earth-dark p-4 rounded-r">
                <p class="text-sm italic text-bark-soft">{drill.data.coachNote}</p>
              </div>
            )}
          </div>
        ))}
      </div>
    </section>
  )}

  <!-- Parent Q&A Section -->
  {relatedQA.length > 0 && (
    <section class="bg-earth-dark p-8 rounded-xl mb-8">
      <h2 class="font-display text-xl font-bold mb-6">Common Questions About Pain</h2>
      <div class="space-y-4">
        {relatedQA.map(qa => (
          <a href={`/parent-sidelines/${qa.slug}/`} class="block p-5 bg-white rounded-lg shadow-sm hover:shadow-md transition">
            <h3 class="font-semibold text-ink mb-2">"{qa.data.question}"</h3>
            <p class="text-bark-soft text-sm line-clamp-2">{qa.data.directAnswer}</p>
            <span class="text-copper text-sm mt-2 inline-block">Read answer ‚Üí</span>
          </a>
        ))}
      </div>
    </section>
  )}

  <!-- General Protocol -->
  <section class="mb-8">
    <h2 class="font-display text-2xl font-bold mb-4">General Rehab Protocol</h2>
    <div class="bg-white rounded-lg shadow-card p-6">
      <p class="text-bark-soft mb-4">
        Most injury-modified barefoot protocols follow this pattern:
      </p>
      <ol class="space-y-4">
        <li class="flex items-start gap-3">
          <span class="w-8 h-8 bg-moss text-white rounded-full flex items-center justify-center font-mono text-sm font-bold flex-shrink-0">1</span>
          <div>
            <strong class="text-ink">Pain-Free ROM</strong>
            <p class="text-sm text-bark-soft">Gentle mobility work within pain-free range. No loading.</p>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <span class="w-8 h-8 bg-moss text-white rounded-full flex items-center justify-center font-mono text-sm font-bold flex-shrink-0">2</span>
          <div>
            <strong class="text-ink">Activation</strong>
            <p class="text-sm text-bark-soft">Short foot, toe exercises, gentle balance. Still minimal load.</p>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <span class="w-8 h-8 bg-moss text-white rounded-full flex items-center justify-center font-mono text-sm font-bold flex-shrink-0">3</span>
          <div>
            <strong class="text-ink">Progressive Loading</strong>
            <p class="text-sm text-bark-soft">Gradually add bodyweight, then movement, then sport-specific work.</p>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <span class="w-8 h-8 bg-moss text-white rounded-full flex items-center justify-center font-mono text-sm font-bold flex-shrink-0">4</span>
          <div>
            <strong class="text-ink">Return to Activity</strong>
            <p class="text-sm text-bark-soft">Sport-specific drills, then practice, then competition.</p>
          </div>
        </li>
      </ol>
    </div>
  </section>
</ClusterHubLayout>
